{
    "instruction": "You will receive sheet data along with an Excel formula. Your task is to generate a query that can reflect the semantics of the corresponding formula.",
    "spreadsheet_data_format_description": "The sheet data will be provided to you in a format as follows: Each data cell in the spreadsheet is represented by a pair consisting of the cell address and cell content, separated by a comma, such as 'A1,Year'. This means that 'A1' is the cell's address, and 'Year' is its content. Cells are separated by a vertical bar ('|'), like 'A1,Year|A2,Profit'. The cell content can be empty, resulting in cell data like 'A1,|A2,Profit'. Cells are organized in row-major order, with different rows in the spreadsheet separated by line breaks. If there are merged cells in the sheet, they are split into multiple cells and only the first cell will be filled with content, other cells will be left as blank. You can visualize the sheet data as a matrix of cells. Following the matrix, all the merged cells are provided in the format '<upper-left address>:<lower-right address>,' like 'A3:C3', with each line representing one merged cell.",
    "output_format": "### Output Format\n{\"Explanation\": explanation, \"Query\": query}\n\nYou should follow the following guidelines to generate query responding to the formula:\n- Natural: Ensure that the query sounds natural and is grammatically correct.\n- Clarity: Ensure that the query should be detailed, precise and unambiguous enough, so that people can understand the semantic of query, and write a formula based on the query. This formula should be the same as the input formula.\n- Query Diversity: Ensure the query exhibits diversity, and the generated query needs to be a declarative statement. For instance, if the formula is '=SUM(B1:B2)', B1 is the number of flowers exported in 2012, and B2 is the number of flowers exported in 2013, then the query can be 'The total number of flowers exported in 2012 and 2013'. \n- Conciseness: Query should be a simple sentence or several phrases that describe the semantic of the formula. The query should not exceed 30 words, revealing the formula's semantic.\n- Avoid including the phrase 'the formula' in the query.\n- Avoid Direct References:\n- Refrain from using specific cell addresses (e.g., \"A1\", \"B2\") or column references in the format of 'Column A' or 'Column 1'. For a formula that calculates the sum of profits like \"=SUM(B1:E1)\", the generated query should not contain string like \"B1\" or \"E1\". Here are some example output queries for this case:\nExample Output1: {\"Query\": \"The total profits\"}\nExample Output2: {\"Query\": \"Sum of the profits.\"}\n- Focus on the purpose and meaning of the formula rather than its specific location.\n- The query should ensure clarity about which data points are being referred to by avoiding vague phrases like 'a certain range' and instead specifying its detailed semantic, as shown in the following correct example: 'Check if the US table value falls between X and Y when X = -3.62 and Y = 5.47.'\n- The generated query should include both the return value when the condition is true and when the condition is false. For example, in a sheet where I25 denotes 'House Rental/Mortgage', J25 is 'Utility Expenses', and $L$21 represents 'Total Gross Salary', the corresponding query for the formula =IF(I25=\"\", \"\", (I25+J25)/SUM($L$21)) can be: \"Calculate the ratio of the sum of 'House Rental/Mortgage' and 'Utility Expenses' to 'Total Gross Salary' if the 'House Rental/Mortgage' value is not empty; otherwise, return an empty string.\" This way, the query includes both results for the condition being true (directly return an empty string) and the condition being false (return the ratio).\n\nWhen the formula contains absolute cell references, don't directly mention cell address in the query. Instead, using natural language to describe its role in the calculation and the semantics informed by the adjacent cells.",
    "guidelines": "### Some Guidelines\nSometimes, the semantic of a cell is determined by semantic of cells in the same row and the same column, or cells in the upper region and left region. When generating query for formula containing such cells, the information of cells that can determine semantics of such cells should be included. This situation is common in \"cross-tables \" region, which contains a left header region and an upper header region. To locate the data used in the formula, the generated query for such cases can include information about the title, the left header and the top header of the data region. More detailed: 1. Add title information if necessary. A sheet may sometimes contain more than one data range, if these data ranges are mainly distinguished by the title, then the query should contain the title information so that we would not use the wrong data range when writing corresponding formula of the generated query. 2. Header hierarchy. There could be several hierarchical layers, you should refer the semantic from the highest layer to the bottom layer if it is necessary to fully reveal the formula semantic. 3. Both left header and top header are critical for deciding the formula semantic, so you should add information of them in the query simultaneously. In essence, the information within the query should be sufficient to uniquely identify the formula.",
    "examples": [
        {
            "sheet_string": "A1,|B1,Calculation of lowpass frequiency cut-off|C1,|D1,|E1,|F1,\nA2,|B2,|C2,|D2,|E2,|F2,\nA3,|B3,Change the fields marked by grey.|C3,|D3,|E3,|F3,\nA4,|B4,|C4,|D4,|E4,|F4,\nA5,|B5,Q|C5,0.77|D5,|E5,|F5,\nA6,|B6,C1|C6,2.7E-07|D6,F|E6,|F6,\nA7,|B7,C2|C7,1.4E-07|D7,F|E7,|F7,\nA8,|B8,Rpot|C8,22000|D8,ohm|E8,|F8,\nA9,|B9,Rseries|C9,5000|D9,ohm|E9,|F9,\nA10,|B10,|C10,|D10,|E10,|F10,\nA11,|B11,Linear potentiometer:|C11,|D11,|E11,|F11,\nA12,|B12,|C12,|D12,|E12,|F12,\nA13,|B13,R|C13,Fc (C1)|D13,Fc (C2)|E13,Fc|F13,log scale?\nA14,|B14,27000|C14,|D14,27.64|E14,30.755|F14,29.77",
            "formula": "=$C$5/(B14*$C$6*PI())",
            "address": "C14",
            "explanation":"The formula \"$C$5/(B14*$C$6*PI())\" represents a calculation where the fixed value Q (absolute cell reference $C$5) is divided by the product of the resistance value 27000(cell B14), the fixed capacitance value for C1 (absolute cell reference $C$6), and the constant PI. The dollar sign ($) indicates that C5 and C6 are absolute references, and they should be described in the query. And the absolute cell references should be described by their semantics rather than referring to their positions.",
            "query": "Calculate the cut-off frequency of C1 in a linear potentiometer when R is 27000."
        },
        {
            "sheet_string": "A1,|B1,|C1,|D1,\nA2,|B2,|C2,|D2,\nA3,MARAC Yearly Totals: Milton Keynes|B3,|C3,|D3,\nA4,|B4,|C4,|D4,\nA5,|B5,2010/11|C5,2011/12|D5,2012/13\nA6,Cases reviewed|B6,210|C6,234|D6,245\nA7,Repeat cases|B7,23|C7,45|D7,67\nA8,Repeat rate|B8,|C8,|D8,\nA9,|B9,|C9,|D9,\nA10,|B10,|C10,|D10,\nA11,% Repeat rate of domestic violence incidence|B11,|C11,|D11,",
            "formula": "=B7/B6",
            "address": "B8",
            "explanation":"For formula in B8, the semantic is determined by cell A8(the left header meaning Repeat rate) and cell B5(the top header meaning 2010/11). Hence, generated query should include information of top header and the left header. In addition, cell A11 is '% Repeat rate of domestic violence incidence ', providing extra information of data range in A5:D8. Hence, one possible query is 'The repeat case rate of domestic violence in 2010/11.'",
            "query": "The repeat case rate of domestic violence in 2010/11."
        },
        {
            "sheet_string": "A1,|B1,|C1,|D1,|E1,|F1,|G1,\nA2,|B2,|C2,|D2,Table - 3. Changes on Rural Arterial Roads by Region and State**|E2,|F2,|G2,\nA3,Region And State|B3,Region And State|C3,Region And State|D3,March|E3,March|F3,March|G3,March\nA4,Region And State|B4,Region And State|C4,Region And State|D4,Number of Stations|E4,Vehicle-Miles(Millions)|F4,Vehicle-Miles(Millions)|G4,Percent Change\nA5,Region And State|B5,Region And State|C5,Region And State|D5,Number of Stations|E5,2011   (Preliminary)|F5,2010|G5,Percent Change,\nA6,|B6,|C6,|D6,|E6,|F6,|G6,\nA7,Northeast|B7,Northeast|C7,Northeast|D7,Northeast|E7,Northeast|F7,Northeast|G7,Northeast\nA8,|B8,|C8,|D8,STATIONS|E8,CMILES|F8,PMILES|G8,CCHANGE\nA9,Connecticut|B9,|C9,|D9,12|E9,123|F9,987|G9,-1.2\nA10,Maine|B10,|C10,|D10,23|E10,234|F10,876|G10,-3.4\nA11,Massachusetts|B11,|C11,|D11,34|E11,345|F11,765|G11,-4.5\nA12,New Hampshire|B12,|C12,|D12,45|E12,456|F12,654|G12,-5.6\nA13,New Jersey|B13,|C13,|D13,56|E13,567|F13,543|G13,-6.7\nA14,New York|B14,|C14,|D14,67|E14,678|F14,432|G14,-7.8\nA15,Pennsylvania|B15,|C15,|D15,78|E15,789|F15,321|G15,-9\nA16,Rhode Island|B16,|C16,|D16,0|E16,90|F16,12|G16,-0.9\nA17,Vermont|B17,|C17,|D17,89|E17,123|F17,234|G17,-0.8\nA18,Subtotal|B18,|C18,|D18,|E18,3405|F18,|G18,\nMerged Ranges:\nA10:C10\nA13:C13\nA11:C11\nA14:C14\nA17:C17\nA18:C18\nA9:C9\nA12:C12\nA16:C16\nA15:C15",
            "formula": "=((E18-F18)/F18)*100",
            "address": "G18",
            "explanation":"In cell G18, the semantic is determined not only by cell A18(the left header meaning Subtotal) and cell G4(the top header meaning Percentage Change), but also cell A7(a parent of header A18, meaning Northeast) and cell range D3:F5 (a complex structured header region, denoting 'Change between 2011 and 2010 in number of stations for vehicle-miles in March'). Hence, a possible query containing the above messages can be 'For vehicle-miles in the Northeast region, the subtotal percent change in number of stations between 2011 and 2010 in March.'",
            "query": "For vehicle-miles in the Northeast region, the subtotal percent change in number of stations between 2011 and 2010 in March."
        },
        {
            "sheet_string": "A1,Date|B1,CAA at Check 13|C1,\nA2,4/6/2014|B2,12.34|C2,\nA3,4/7/2014|B3,23.45|C3,74.2\nA4,4/8/2014|B4,34.56|C4,94.2\nA5,4/9/2014|B5,45.67|C5,114.2\nA6,4/10/2014|B6,56.78|C6,134.2\nA7,4/11/2014|B7,67.89|C7,154.2\nA8,4/12/2014|B8,98.76|C8,209.8\nA9,4/13/2014|B9,87.65|C9,189.8\nA10,4/14/2014|B10,76.54|C10,169.8\nA11,4/15/2014|B11,65.43|C11,149.8\nA12,4/16/2014|B12,54.32|C12,129.8\nA13,4/17/2014|B13,32.1|C13,89.8\nA14,4/18/2014|B14,21.09|C14,70\nA15,4/19/2014|B15,|C15,\nA16,4/20/2014|B16,|C16,\nA17,4/21/2014|B17,|C17,\nA18,4/22/2014|B18,10.98|C18,\nA19,4/23/2014|B19,98.76|C19,209.8\nA20,4/24/2014|B20,87.65|C20,189.8\nA21,4/25/2014|B21,76.54|C21,169.8\nA22,4/26/2014|B22,65.43|C22,149.8\nA23,4/27/2014|B23,54.32|C23,129.8\nA24,4/28/2014|B24,43.21|C24,109.8\nA25,4/29/2014|B25,32.1|C25,89.8\nA26,4/30/2014|B26,10.98|C26,51.8\nA27,5/1/2014|B27,12.34|C27,54.2\nA28,5/2/2014|B28,23.45|C28,74.2\nA29,5/3/2014|B29,34.56|C29,94.2\nA30,5/4/2014|B30,45.67|C30,114.2",
            "formula": "=IF(B2>0,32+9*B2/5,NA())",
            "address": "C2",
            "explanation":"The formula =IF(B2>0,32+9*B2/5,NA()) is applied to the row where the Date is 4/6/2014. It checks whether the value in the CAA at Check 13 area for this date is greater than 0. If the value is greater than 0, the formula converts the temperature from Celsius to Fahrenheit using the formula 32 + 9*B2/5. If the value is not greater than 0, it returns 'NA'",
            "query": "Convert the temperature from Celsius to Fahrenheit in Date 4/6/2014 if the Celsius temperature is greater than 0, otherwise mark it as 'NA'."
        }
    ]
}